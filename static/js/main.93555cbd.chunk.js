(this["webpackJsonplogic-gate-simulator"]=this["webpackJsonplogic-gate-simulator"]||[]).push([[0],{21:function(e,n,t){e.exports=t(34)},26:function(e,n,t){},34:function(e,n,t){"use strict";t.r(n);var o=t(0),i=t.n(o),r=t(9),a=t.n(r),s=(t(26),t(2)),c=t(3),u=t(5),d=t(4),l=t(16),f=t(6),m=t(17),p=t.n(m),v=t(11),h=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(){var e;Object(s.a)(this,t);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i))).toggleSwitch=function(){e.props.nodeInfo.switchEnabled=!e.props.nodeInfo.switchEnabled,e.props.simulate()},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this,n=this.props,t=n.nodeInfo,o=n.connections;return i.a.createElement(p.a,{handle:".node__container",defaultPosition:t.defaultPos,positionOffset:this.props.positionOffset},i.a.createElement("div",{className:"node",id:t.id},i.a.createElement("div",{className:"node__container "+(t.status?"node__container--active":""),onContextMenu:function(){return e.props.removeNode()}},i.a.createElement("div",{className:"node__name"},t.nodeType.name),null!==t.nodeType.svg&&i.a.createElement("div",{className:"node__svg "+(t.status?"node__svg--active":"")},i.a.createElement(v.a,{src:"assets/".concat(t.nodeType.svg)})),t.nodeType.hasSwitch&&i.a.createElement("div",{className:"switch "+(t.switchEnabled?"switch--active":""),onClick:function(){return e.toggleSwitch()}},i.a.createElement("div",{className:"switch__inner"}))),i.a.createElement("div",{className:"node__inputs"},t.inputs.map((function(n,r){return i.a.createElement("div",{key:r,id:n,className:"node__point "+(t.hasIncomingConnectionsOnPort(n,o)?"node__point--filled":""),onMouseUp:function(t){return e.props.connectLine(n)},onContextMenu:function(){return e.props.removeConnections(n)}})}))),i.a.createElement("div",{className:"node__outputs"},t.outputs.map((function(n,t){return i.a.createElement("div",{key:t,id:n,className:"node__point node__point--filled",onMouseDown:function(){return e.props.startLine(n)},onContextMenu:function(){return e.props.removeConnections(n)}})})))))}}]),t}(o.Component),g=t(36),y={INPUT:{inputs:0,outputs:1,name:"INPUT",hasSwitch:!0,transform:function(e,n){return n},key:"i",svg:null},OUTPUT:{inputs:1,outputs:0,name:"OUTPUT",hasSwitch:!1,transform:function(e,n){return e[0]},key:"u",svg:null},NOT_GATE:{inputs:1,outputs:1,name:"NOT-GATE",hasSwitch:!1,transform:function(e,n){return!e[0]},key:"n",svg:"not.svg"},AND_GATE:{inputs:2,outputs:1,name:"AND-GATE",hasSwitch:!1,transform:function(e,n){return e[0]&&e[1]},key:"a",svg:"and.svg"},OR_GATE:{inputs:2,outputs:1,name:"OR-GATE",hasSwitch:!1,transform:function(e,n){return e[0]||e[1]},key:"o",svg:"or.svg"},NAND_GATE:{inputs:2,outputs:1,name:"NAND-GATE",hasSwitch:!1,transform:function(e,n){return!(e[0]&&e[1])},key:"A",svg:"nand.svg"}},N=function e(n){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(g.a)(),r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(s.a)(this,e),this.hasIncomingConnectionsOnPort=function(e,n){return void 0!==n.find((function(n){return n.to.id===e}))},this.getProcessedInput=function(e){var n=e.filter((function(e){return e.to.nodeInfo.id===t.id})).map((function(e){return e.from.nodeInfo.status}));return[].concat(Object(f.a)(n),Object(f.a)(Array(t.nodeType.inputs-n.length).fill(!1)))},this.simulate=function(e){t.status=t.nodeType.transform(t.getProcessedInput(e),t.switchEnabled)},this.getStorageObject=function(){if(null===document.getElementById(t.id))return null;var e=document.getElementById(t.id).getBoundingClientRect();return{id:t.id,nodeTypeKey:Object.keys(y).find((function(e){return y[e]===t.nodeType})),pos:{x:e.x,y:e.y},status:t.status,switchEnabled:t.switchEnabled}},this.id=i,this.nodeType=n,this.defaultPos=o,this.switchEnabled=a,this.status=r,this.inputs=[],this.outputs=[];for(var c=0;c<n.inputs;c++)this.inputs.push("NODE-".concat(this.id,"_INPUT-").concat(c));for(var u=0;u<n.outputs;u++)this.outputs.push("NODE-".concat(this.id,"_OUTPUT-").concat(u))},w=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(){var e;Object(s.a)(this,t);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i))).state={points:"",connections:[],nodes:[]},e.fromNode=null,e.loadedFromLocalStorage=!1,e.startLine=function(n,t){e.fromNode={nodeInfo:n,id:t}},e.mouseMove=function(n,t){if(null!==e.fromNode){var o=document.getElementById(e.fromNode.id).getBoundingClientRect(),i=o.x,r=o.y,a=o.width,s=o.height;e.setState({points:"".concat(i+a/2,",").concat(r+s/2," ").concat(n,",").concat(t)})}},e.mouseUp=function(){e.fromNode=null,e.setState({points:""})},e.connectLine=function(n,t){null!==e.fromNode&&(void 0===e.state.connections.find((function(e){return e.to.id===t}))&&e.setState({points:"",connections:[].concat(Object(f.a)(e.state.connections),[{from:e.fromNode,to:{nodeInfo:n,id:t}}])},(function(){return e.simulate()})),e.fromNode=null)},e.getConnectionLineOfConnection=function(e){if(null===document.getElementById(e.from.id)||null===document.getElementById(e.to.id))return"";var n=document.getElementById(e.from.id).getBoundingClientRect(),t=document.getElementById(e.to.id).getBoundingClientRect();return"".concat(n.x+n.width/2,",").concat(n.y+n.height/2," ").concat(t.x+t.width/2,",").concat(t.y+t.height/2)},e.simulate=function(){for(var n=0;n<50;n++){var t,o=JSON.stringify(e.state.nodes.map((function(e){return e.status}))),i=Object(l.a)(e.state.nodes);try{for(i.s();!(t=i.n()).done;){t.value.simulate(e.state.connections)}}catch(r){i.e(r)}finally{i.f()}if(o===JSON.stringify(e.state.nodes.map((function(e){return e.status}))))break}e.setState({})},e.removeConnection=function(n){null===e.fromNode&&e.setState({connections:e.state.connections.filter((function(e){return e!==n}))},(function(){return e.simulate()}))},e.removeConnections=function(n){null===e.fromNode&&e.setState({connections:e.state.connections.filter((function(e){return e.from.id!==n&&e.to.id!==n}))},(function(){return e.simulate()}))},e.getConnectionStorageObject=function(e){return{fromNodeId:e.from.nodeInfo.id,fromPointId:e.from.id,toNodeId:e.to.nodeInfo.id,toPointId:e.to.id}},e.save=function(){if(e.loadedFromLocalStorage){var n=JSON.stringify(e.state.nodes.map((function(e){return e.getStorageObject()})).filter((function(e){return null!==e})));localStorage.setItem("nodes",n);var t=JSON.stringify(e.state.connections.map((function(n){return e.getConnectionStorageObject(n)})));localStorage.setItem("connections",t)}},e.load=function(){var n=[],t=[];null!==localStorage.getItem("nodes")&&(n=JSON.parse(localStorage.getItem("nodes")).map((function(e){return new N(y[e.nodeTypeKey],e.pos,e.id,e.status,e.switchEnabled)}))),null!==localStorage.getItem("connections")&&(t=JSON.parse(localStorage.getItem("connections")).map((function(e){return{from:{nodeInfo:n.find((function(n){return n.id===e.fromNodeId})),id:e.fromPointId},to:{nodeInfo:n.find((function(n){return n.id===e.toNodeId})),id:e.toPointId}}}))),e.setState({nodes:n,connections:t},(function(){e.loadedFromLocalStorage=!0,e.simulate()}))},e.addNewNode=function(n){var t=e.props.position,o=t.x,i=t.y;o=-o+Math.floor(window.innerWidth/2)-100,i=-i+Math.floor(window.innerHeight/2)-50,e.setState({nodes:[].concat(Object(f.a)(e.state.nodes),[new N(n,{x:o,y:i})])},(function(){return e.simulate()}))},e.removeNode=function(n){e.setState({nodes:e.state.nodes.filter((function(e){return e.id!==n})),connections:e.state.connections.filter((function(e){return e.from.nodeInfo.id!==n&&e.to.nodeInfo.id!==n}))},(function(){return e.simulate()}))},e}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.load(),window.addEventListener("keydown",(function(n){var t=Object.values(y).find((function(e){return e.key===n.key}));void 0!==t&&e.addNewNode(t)}))}},{key:"render",value:function(){var e=this;return this.save(),i.a.createElement("div",{className:"desktop",onMouseMove:function(n){return e.mouseMove(n.clientX,n.clientY)},onMouseUp:function(){return e.mouseUp()},onContextMenu:function(e){return e.preventDefault()}},i.a.createElement("svg",{className:"line"},i.a.createElement("polyline",{points:this.state.points})),this.state.connections.map((function(n){return{connection:n,line:e.getConnectionLineOfConnection(n)}})).map((function(n,t){var o=n.connection,r=n.line;return i.a.createElement("svg",{className:"line "+(o.from.nodeInfo.status?"line--active":""),key:t},i.a.createElement("polyline",{points:r,onContextMenu:function(){return e.removeConnection(o)}}))})),this.state.nodes.map((function(n){return i.a.createElement(h,{key:n.id,startLine:function(t){return e.startLine(n,t)},connectLine:function(t){return e.connectLine(n,t)},removeConnections:function(n){return e.removeConnections(n)},removeNode:function(){return e.removeNode(n.id)},nodeInfo:n,connections:e.state.connections,simulate:function(){return e.simulate()},positionOffset:e.props.position})})))}}]),t}(o.Component),E=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"sidebar"},Object.values(y).map((function(n,t){return i.a.createElement("div",{className:"sidebar-item",key:t,onClick:function(){return e.props.addNewNode(n)}},i.a.createElement("div",{className:"sidebar-item__name"},n.name),i.a.createElement("div",{className:"sidebar-item__svg"},i.a.createElement(v.a,{src:"assets/".concat(n.svg)})))})))}}]),t}(o.Component),b=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(){var e;Object(s.a)(this,t);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=n.call.apply(n,[this].concat(r))).state={desktopX:0,desktopY:0},e.mouseStartPos=null,e.desktopRef=i.a.createRef(),e.mouseDown=function(n,t,o){1===o&&(e.mouseStartPos={x:n,y:t,desktopX:e.state.desktopX,desktopY:e.state.desktopY})},e.mouseMove=function(n,t){if(null!==e.mouseStartPos){var o=e.mouseStartPos,i=o.x,r=o.y,a=o.desktopX,s=o.desktopY;e.setState({desktopX:a-(i-n),desktopY:s-(r-t)})}},e.mouseUp=function(){e.mouseStartPos=null},e.addNewNode=function(n){e.desktopRef.current.addNewNode(n)},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"app",onMouseDown:function(n){return e.mouseDown(n.clientX,n.clientY,n.button)},onMouseMove:function(n){return e.mouseMove(n.clientX,n.clientY)},onMouseUp:function(){return e.mouseUp()}},i.a.createElement(w,{position:{x:this.state.desktopX,y:this.state.desktopY},ref:this.desktopRef}),i.a.createElement(E,{addNewNode:function(n){return e.addNewNode(n)}}))}}]),t}(o.Component),O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function k(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a.a.render(i.a.createElement(b,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");O?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var o=t.headers.get("content-type");404===t.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):k(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):k(n,e)}))}}()}},[[21,1,2]]]);
//# sourceMappingURL=main.93555cbd.chunk.js.map